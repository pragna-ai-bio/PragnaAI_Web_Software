<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PragnaAI Research – AI-powered Cancer Photoacoustic Diagnosis</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary-color: #0d4a8c;
            --primary-dark: #0a3a70;
            --primary-light: #0d7ba8;
            --secondary-color: #0d2a4d;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --light-bg: #f8f9fa;
            --white: #ffffff;
            --text-dark: #222222;
            --text-light: #555555;
            --border-color: #e1e5eb;
            --shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        body {
            background: var(--white);
            color: var(--text-dark);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        
        /* Welcome Screen Styles with Lighter Dense Net Background */
        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #f5f5f5; /* lighter grey */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.5s ease;
        }
        
        .welcome-content {
            position: relative;
            z-index: 1001;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .welcome-logo {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 40px;
        }
        
        .welcome-logo-text {
            font-size: 5rem;
            font-weight: 700; /* Back to original weight */
            color: var(--secondary-color);
            text-align: center;
        }
        
        .tagline {
            font-size: 1.2rem; /* Back to original size */
            color: var(--primary-color);
            margin-top: 20px;
            text-align: center;
            font-weight: 500; /* Back to original weight */
        }
        
        .get-started-btn {
            padding: 18px 50px;
            background: linear-gradient(45deg, var(--primary-color), var(--primary-light));
            color: var(--white);
            border: none;
            border-radius: 8px;
            font-size: 1.4rem;
            font-weight: 600; /* Back to original weight */
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            margin-top: 40px;
            box-shadow: 0 4px 6px rgba(13, 74, 140, 0.2);
        }
        
        .get-started-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 14px rgba(13, 74, 140, 0.3);
            background: linear-gradient(45deg, var(--primary-dark), #0b6a8a);
        }
        
        .get-started-btn:active {
            transform: translateY(0);
        }
        
        /* Lighter Dense Net Background Canvas */
        #bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: block;
            z-index: 1000;
        }
        
        /* Educational Page Styles */
        .educational-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--light-bg);
            display: flex;
            flex-direction: column;
            z-index: 1500;
            overflow-y: auto;
            display: none;
        }
        
        .educational-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            flex: 1;
        }
        
        .educational-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .educational-title {
            font-size: 3rem;
            color: var(--secondary-color);
            margin-bottom: 20px;
        }
        
        .educational-subtitle {
            font-size: 1.5rem;
            color: var(--primary-color);
        }
        
        .educational-section {
            margin: 40px 0;
            padding: 30px;
            background: var(--white);
            border-radius: 15px;
            box-shadow: var(--shadow);
        }
        
        .educational-section-title {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(13, 74, 140, 0.3);
        }
        
        .educational-text {
            font-size: 1.2rem;
            line-height: 1.8;
            margin-bottom: 20px;
        }
        
        .educational-list {
            margin-left: 30px;
            margin-bottom: 20px;
        }
        
        .educational-list li {
            margin-bottom: 15px;
            font-size: 1.2rem;
            line-height: 1.6;
        }
        
        .educational-diagram {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }
        
        .diagram-container {
            background: var(--white);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            width: 100%;
        }
        
        .diagram-title {
            text-align: center;
            font-size: 1.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .diagram-steps {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .diagram-step {
            display: flex;
            align-items: center;
            padding: 15px;
            background: #f0f7ff;
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
        }
        
        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-color);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 20px;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .step-text {
            flex: 1;
            font-size: 1.1rem;
        }
        
        .molecular-structure {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .structure-formula {
            font-family: monospace;
            font-size: 2rem;
            margin: 15px 0;
            color: var(--primary-color);
        }
        
        .structure-label {
            font-size: 1.1rem;
            color: var(--text-light);
        }
        
        .next-page-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            padding: 15px 30px;
            background: linear-gradient(45deg, var(--primary-color), var(--primary-light));
            color: var(--white);
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            box-shadow: 0 4px 6px rgba(13, 74, 140, 0.2);
            z-index: 1600;
        }
        
        .next-page-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 14px rgba(13, 74, 140, 0.3);
            background: linear-gradient(45deg, var(--primary-dark), #0b6a8a);
        }
        
        /* Rest of the CSS remains exactly the same */
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            background: var(--light-bg);
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--shadow);
            flex: 1;
            display: none; /* Initially hidden */
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
        }
        
        .logo {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .logo-text {
            font-size: 4.5rem;
            font-weight: 700;
            color: var(--secondary-color);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: var(--secondary-color);
            margin-top: 10px;
            font-weight: 600;
        }
        
        .author {
            font-size: 1rem;
            color: var(--secondary-color);
            margin-top: 5px;
            font-weight: 500;
        }
        
        .section {
            margin: 40px 0;
            padding: 30px;
            background: var(--white);
            border-radius: 15px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }
        
        .section.patient-info-section,
        .section.infrared-readings-section {
            border: 3px solid #000000;
        }
        
        .section-title {
            font-size: 1.8rem;
            color: var(--primary-color);
            margin-bottom: 25px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(13, 74, 140, 0.3);
        }
        
        .input-group {
            margin-bottom: 25px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 12px;
            font-size: 1.1rem;
            color: #333333;
            font-weight: 500;
        }
        
        .input-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1.1rem;
            background: var(--white);
            color: var(--text-dark);
            transition: all 0.3s;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(13, 74, 140, 0.2);
        }
        
        .gender-selection {
            margin-top: 15px;
        }
        
        .gender-label {
            display: block;
            margin-bottom: 12px;
            font-size: 1.1rem;
            color: #333333;
            font-weight: 500;
        }
        
        .gender-options {
            display: flex;
            gap: 20px;
        }
        
        .gender-option {
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        
        .gender-option input {
            margin-right: 8px;
            width: auto;
        }
        
        .feedback {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            font-size: 0.95rem;
            display: none;
        }
        
        .feedback.normal {
            background: rgba(46, 204, 113, 0.15);
            color: #1e7e34;
            display: block;
            border-left: 4px solid #1e7e34;
        }
        
        .feedback.high {
            background: rgba(231, 76, 60, 0.15);
            color: #a71e2a;
            display: block;
            border-left: 4px solid #a71e2a;
        }
        
        .feedback.low {
            background: rgba(241, 196, 15, 0.15);
            color: #b37400;
            display: block;
            border-left: 4px solid #b37400;
        }
        
        .feedback.error {
            background: rgba(231, 76, 60, 0.15);
            color: #a71e2a;
            display: block;
            border-left: 4px solid #a71e2a;
        }
        
        .btn {
            display: block;
            width: 100%;
            padding: 18px;
            background: linear-gradient(45deg, var(--primary-color), var(--primary-light));
            color: var(--white);
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            margin-top: 20px;
            box-shadow: 0 4px 6px rgba(13, 74, 140, 0.2);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 14px rgba(13, 74, 140, 0.3);
            background: linear-gradient(45deg, var(--primary-dark), #0b6a8a);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-alt {
            background: linear-gradient(45deg, var(--secondary-color), var(--primary-color));
        }
        
        .btn-alt:hover {
            background: linear-gradient(45deg, #081d38, var(--primary-dark));
        }
        
        .result {
            margin-top: 30px;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            display: none;
        }
        
        .result.high-risk {
            background: #ffeaea;
            border: 2px solid var(--danger-color);
            display: block;
        }
        
        .result.low-risk {
            background: #e8f7ef;
            border: 2px solid var(--success-color);
            display: block;
        }
        
        .probability-meter {
            height: 30px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 15px;
            margin: 20px 0;
            overflow: hidden;
            position: relative;
            border: 1px solid var(--border-color);
        }
        
        .probability-fill {
            height: 100%;
            border-radius: 15px;
            transition: width 0.5s ease-in-out;
        }
        
        .probability-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.9rem;
            color: var(--text-light);
        }
        
        .risk-level {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 15px 0;
        }
        
        .recommendation {
            margin-top: 15px;
            font-size: 1.1rem;
            line-height: 1.5;
            padding: 15px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.7);
            color: var(--text-dark);
        }
        
        .patient-info {
            margin-top: 20px;
            padding: 15px;
            background: var(--white);
            border-radius: 8px;
            text-align: left;
            border: 2px solid #000000;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .patient-info p {
            margin: 10px 0;
            font-size: 1.1rem;
            color: var(--text-dark);
        }
        
        .patient-counter {
            text-align: center;
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: var(--primary-color);
            font-weight: 600;
            padding: 15px;
            background: var(--white);
            border-radius: 8px;
            border: 2px solid #000000;
        }
        
        .next-patient {
            display: none;
            margin-top: 20px;
            text-align: center;
        }
        
        .api-status {
            display: none !important;
        }
        
        .disclaimer {
            margin-top: 30px;
            padding: 15px;
            background: #fff3cd;
            border: 2px solid #856404;
            border-radius: 8px;
            font-size: 0.85rem;
            color: #664d03;
            text-align: center;
            font-weight: 500;
        }
        
        .footer-text {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            color: #4a6fa5;
            font-size: 1rem;
            font-weight: 500;
        }
        
        .graph-container {
            margin: 30px 0;
            padding: 20px;
            background: var(--white);
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--border-color);
        }
        
        .graph-title {
            font-size: 1.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            text-align: center;
        }
        
        .graph-description {
            font-size: 1rem;
            color: var(--text-light);
            margin-bottom: 20px;
            text-align: center;
        }
        
        .graph-canvas-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        .molecular-reasons {
            margin-top: 25px;
            padding: 20px;
            background: var(--light-bg);
            border-radius: 10px;
            border: 2px solid var(--primary-color);
            text-align: left;
        }
        
        .molecular-reasons h4 {
            font-size: 1.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            text-align: center;
        }
        
        .molecular-reasons ul {
            margin-left: 20px;
            margin-bottom: 20px;
        }
        
        .molecular-reasons li {
            margin-bottom: 10px;
            font-size: 1.1rem;
            line-height: 1.5;
        }
        
        .sequence-example {
            margin-top: 15px;
            padding: 15px;
            background: var(--white);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            font-family: monospace;
            font-size: 1.2rem;
            text-align: center;
        }
        
        .sequence-arrow {
            display: inline-block;
            margin: 0 15px;
            font-size: 1.5rem;
            color: var(--primary-color);
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .action-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .action-btn.schedule {
            background: linear-gradient(45deg, var(--primary-color), var(--primary-light));
            color: var(--white);
        }
        
        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 14px rgba(13, 74, 140, 0.3);
        }
        
        .redirect-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--white);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            display: none;
        }
        
        .redirect-content {
            text-align: center;
            padding: 40px;
            background: var(--light-bg);
            border-radius: 15px;
            box-shadow: var(--shadow);
            max-width: 600px;
            width: 90%;
        }
        
        .redirect-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--secondary-color);
            margin-bottom: 20px;
        }
        
        .redirect-message {
            font-size: 1.2rem;
            color: var(--primary-color);
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        .back-btn {
            padding: 15px 30px;
            background: linear-gradient(45deg, var(--primary-color), var(--primary-light));
            color: var(--white);
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            box-shadow: 0 4px 6px rgba(13, 74, 140, 0.2);
        }
        
        .back-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 14px rgba(13, 74, 140, 0.3);
            background: linear-gradient(45deg, var(--primary-dark), #0b6a8a);
        }
        
        .scheduling-options {
            margin-top: 20px;
            padding: 20px;
            background: var(--light-bg);
            border-radius: 10px;
            border: 2px solid var(--primary-color);
            text-align: left;
            display: none;
        }
        
        .scheduling-title {
            font-size: 1.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            text-align: center;
        }
        
        .scheduling-urgency {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .urgency-option {
            flex: 1;
            min-width: 200px;
            margin: 10px;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .urgency-option:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
        }
        
        .urgency-option.selected {
            border-color: var(--primary-color);
            background: rgba(13, 74, 140, 0.1);
        }
        
        .urgency-high {
            background: #ffeaea;
            border-color: var(--danger-color);
        }
        
        .urgency-medium {
            background: #fff3cd;
            border-color: var(--warning-color);
        }
        
        .urgency-low {
            background: #e8f7ef;
            border-color: var(--success-color);
        }
        
        .urgency-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .urgency-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .urgency-desc {
            font-size: 0.9rem;
            color: var(--text-light);
        }
        
        .test-options {
            margin-top: 20px;
        }
        
        .test-options h4 {
            font-size: 1.3rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            text-align: center;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .test-option {
            display: flex;
            align-items: center;
            padding: 10px;
            background: var(--white);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .test-option:hover {
            background: #f0f7ff;
            border-color: var(--primary-color);
        }
        
        .test-option.selected {
            background: rgba(13, 74, 140, 0.1);
            border-color: var(--primary-color);
        }
        
        .test-checkbox {
            margin-right: 10px;
        }
        
        .test-name {
            font-size: 1rem;
            font-weight: 500;
        }
        
        .schedule-form {
            margin-top: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(13, 74, 140, 0.2);
        }
        
        .form-row {
            display: flex;
            gap: 15px;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        .schedule-submit {
            margin-top: 20px;
            padding: 15px;
            background: linear-gradient(45deg, var(--primary-color), var(--primary-light));
            color: var(--white);
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
        }
        
        .schedule-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 14px rgba(13, 74, 140, 0.3);
            background: linear-gradient(45deg, var(--primary-dark), #0b6a8a);
        }
        
        .test-suggestions {
            margin-top: 15px;
            padding: 15px;
            background: #e8f4ff;
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
        }
        
        .test-suggestions h5 {
            font-size: 1.1rem;
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .test-suggestions ul {
            margin-left: 20px;
            color: var(--primary-color);
        }
        
        .test-suggestions li {
            margin-bottom: 5px;
        }
        
        /* New Enhanced Features */
        .progress-container {
            margin: 20px 0;
            padding: 15px;
            background: var(--white);
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .progress-step {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .step-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--primary-color);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-weight: bold;
        }
        
        .step-text {
            flex: 1;
        }
        
        .step-completed .step-number {
            background: var(--success-color);
        }
        
        .ai-reasoning {
            margin-top: 20px;
            padding: 15px;
            background: #f0f7ff;
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
        }
        
        .ai-reasoning h4 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .confidence-meter {
            margin: 15px 0;
        }
        
        .confidence-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .confidence-bar {
            height: 10px;
            background: #e1e5eb;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success-color), var(--primary-color));
            border-radius: 5px;
            transition: width 0.5s;
        }
        
        .data-source {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-top: 5px;
            text-align: right;
        }
        
        .decision-log {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            max-height: 200px;
            overflow-y: auto;
        }
        
        .decision-log h4 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .log-entry {
            padding: 8px;
            border-bottom: 1px solid var(--border-color);
            font-size: 0.9rem;
        }
        
        .log-entry:last-child {
            border-bottom: none;
        }
        
        .log-time {
            color: var(--text-light);
            font-size: 0.8rem;
        }
        
        .adaptive-learning {
            margin-top: 20px;
            padding: 15px;
            background: #fff3cd;
            border-radius: 8px;
            border: 1px solid var(--warning-color);
        }
        
        .adaptive-learning h4 {
            color: var(--warning-color);
            margin-bottom: 10px;
        }
        
        .multi-agent-system {
            margin-top: 20px;
            padding: 15px;
            background: #e8f7ef;
            border-radius: 8px;
            border: 1px solid var(--success-color);
        }
        
        .multi-agent-system h4 {
            color: var(--success-color);
            margin-bottom: 10px;
        }
        
        .agent-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .agent-card {
            padding: 10px;
            background: var(--white);
            border-radius: 5px;
            border-left: 3px solid var(--primary-color);
            font-size: 0.9rem;
        }
        
        .proactive-actions {
            margin-top: 20px;
            padding: 15px;
            background: #ffeaea;
            border-radius: 8px;
            border: 1px solid var(--danger-color);
        }
        
        .proactive-actions h4 {
            color: var(--danger-color);
            margin-bottom: 10px;
        }
        
        .action-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .action-icon {
            margin-right: 10px;
            color: var(--primary-color);
        }

        .lactic-acid-info {
            margin-top: 20px;
            padding: 15px;
            background: #f0f7ff;
            border-radius: 8px;
            border: 2px solid var(--primary-color);
            text-align: center;
        }

        .lactic-acid-structure {
            font-family: monospace;
            font-size: 1.2rem;
            margin: 10px 0;
            padding: 10px;
            background: var(--white);
            border-radius: 5px;
        }

        @media (max-width: 768px) {
            .welcome-logo-text {
                font-size: 3.5rem;
            }
            
            .tagline {
                font-size: 1rem;
            }
            
            .get-started-btn {
                padding: 15px 40px;
                font-size: 1.2rem;
            }
            
            .educational-title {
                font-size: 2.5rem;
            }
            
            .educational-subtitle {
                font-size: 1.2rem;
            }
            
            .educational-section {
                padding: 20px;
            }
            
            .educational-section-title {
                font-size: 1.5rem;
            }
            
            .educational-text {
                font-size: 1.1rem;
            }
            
            .structure-formula {
                font-size: 1.5rem;
            }
            
            .next-page-btn {
                bottom: 20px;
                right: 20px;
                padding: 12px 25px;
                font-size: 1.1rem;
            }
            
            .container {
                width: 95%;
                padding: 20px;
            }
            
            .logo-text {
                font-size: 3rem;
            }
            
            .section {
                padding: 20px;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .gender-options {
                flex-direction: column;
                gap: 10px;
            }
            
            .disclaimer {
                font-size: 0.8rem;
                padding: 12px;
            }
            
            .footer-text {
                font-size: 0.9rem;
                padding: 10px;
            }
            
            .graph-canvas-container {
                height: 250px;
            }
            
            .sequence-example {
                font-size: 1rem;
            }
            
            .sequence-arrow {
                margin: 0 10px;
                font-size: 1.2rem;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .redirect-title {
                font-size: 2rem;
            }
            
            .redirect-message {
                font-size: 1rem;
            }
            
            .scheduling-urgency {
                flex-direction: column;
            }
            
            .urgency-option {
                min-width: 100%;
            }
            
            .test-grid {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                flex-direction: column;
            }
            
            .agent-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Welcome Screen with Get Started Button and Lighter Dense Net Background -->
    <div class="welcome-screen" id="welcome-screen">
        <canvas id="bg"></canvas>
        <div class="welcome-content">
            <div class="welcome-logo">
                <div class="welcome-logo-text">PragnaAI Research</div>
            </div>
            <button class="get-started-btn" id="get-started-btn">GET STARTED</button>
            <div class="tagline">Intersection of Biology and Technology</div>
        </div>
    </div>

    <!-- Educational Page About Spectroscopy -->
    <div class="educational-page" id="educational-page">
        <div class="educational-content">
            <div class="educational-header">
                <h1 class="educational-title">Understanding Spectroscopy in Cancer Detection</h1>
                <div class="educational-subtitle">How Photoacoustic Spectroscopy Works and How Our System Functions</div>
            </div>
            
            <div class="educational-section">
                <h2 class="educational-section-title">What is Photoacoustic Spectroscopy?</h2>
                <p class="educational-text">
                    Photoacoustic spectroscopy is an advanced analytical technique that combines light absorption with sound detection. When molecules absorb light energy, they heat up and expand, creating pressure waves that can be detected as sound. This technique is particularly valuable in biomedical applications because it provides detailed molecular information without invasive procedures.
                </p>
                
                <div class="educational-diagram">
                    <div class="diagram-container">
                        <h3 class="diagram-title">Photoacoustic Spectroscopy Process</h3>
                        <div class="diagram-steps">
                            <div class="diagram-step">
                                <div class="step-number">1</div>
                                <div class="step-text">Laser light is directed at the tissue sample</div>
                            </div>
                            <div class="diagram-step">
                                <div class="step-number">2</div>
                                <div class="step-text">Molecules in the tissue absorb specific wavelengths of light</div>
                            </div>
                            <div class="diagram-step">
                                <div class="step-number">3</div>
                                <div class="step-text">Absorbed energy causes rapid heating and expansion</div>
                            </div>
                            <div class="diagram-step">
                                <div class="step-number">4</div>
                                <div class="step-text">Expansion generates ultrasonic pressure waves</div>
                            </div>
                            <div class="diagram-step">
                                <div class="step-number">5</div>
                                <div class="step-text">Special sensors detect these acoustic signals</div>
                            </div>
                            <div class="diagram-step">
                                <div class="step-number">6</div>
                                <div class="step-text">Computer analysis converts signals to molecular information</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="educational-section">
                <h2 class="educational-section-title">Lactic Acid as a Cancer Biomarker</h2>
                <p class="educational-text">
                    Cancer cells exhibit altered metabolism known as the Warburg effect, where they preferentially use glycolysis for energy production even in the presence of oxygen. This metabolic shift results in increased lactic acid production, making lactic acid levels and molecular structure valuable indicators of cancerous activity.
                </p>
                
                <div class="molecular-structure">
                    <h3>Lactic Acid Molecular Structure</h3>
                    <div class="structure-formula">CH₃-CH(OH)-COOH</div>
                    <div class="structure-label">Key functional groups analyzed in our system:</div>
                    <ul class="educational-list">
                        <li><strong>Carbonyl Group (-C=O):</strong> Stretching vibrations around 1720 cm⁻¹</li>
                        <li><strong>Methyl Group (-CH₃):</strong> Deformation vibrations around 1300 cm⁻¹</li>
                        <li><strong>Carbon-Oxygen Stretch (-C-OH):</strong> Vibrations around 1100 cm⁻¹</li>
                        <li><strong>Hydroxyl Group (-O-H):</strong> Stretching vibrations around 3500 cm⁻¹</li>
                    </ul>
                </div>
            </div>
            
            <div class="educational-section">
                <h2 class="educational-section-title">How Our System Works</h2>
                <p class="educational-text">
                    Our AI-powered system analyzes photoacoustic spectroscopy data to detect subtle changes in lactic acid molecular vibrations that indicate cancerous metabolic activity. The process integrates cutting-edge spectroscopy with advanced machine learning algorithms.
                </p>
                
                <ul class="educational-list">
                    <li><strong>Data Collection:</strong> Photoacoustic spectroscopy equipment captures molecular vibration data from tissue samples</li>
                    <li><strong>Signal Processing:</strong> Raw acoustic signals are processed to extract specific molecular vibration frequencies</li>
                    <li><strong>Feature Extraction:</strong> Key lactic acid molecular features are identified and quantified</li>
                    <li><strong>AI Analysis:</strong> Machine learning models compare the extracted features against known cancer biomarkers</li>
                    <li><strong>Risk Assessment:</strong> The system calculates cancer probability based on metabolic alterations</li>
                    <li><strong>Clinical Decision Support:</strong> Results are presented with actionable recommendations for healthcare providers</li>
                </ul>
                
                <p class="educational-text">
                    This non-invasive approach allows for early detection of metabolic changes associated with cancer, potentially enabling intervention before structural changes become apparent through traditional imaging methods.
                </p>
            </div>
            
            <div class="educational-section">
                <h2 class="educational-section-title">For Healthcare Professionals</h2>
                <p class="educational-text">
                    This system is designed to complement your clinical expertise by providing additional metabolic insights. The interface allows you to:
                </p>
                
                <ul class="educational-list">
                    <li>Input patient demographic information for personalized analysis</li>
                    <li>Enter spectroscopic readings from four key lactic acid molecular vibrations</li>
                    <li>Receive AI-powered cancer probability assessments</li>
                    <li>Access detailed molecular reasoning behind the assessment</li>
                    <li>Generate follow-up test recommendations based on risk level</li>
                    <li>Schedule additional diagnostic procedures directly through the system</li>
                </ul>
                
                <p class="educational-text">
                    The system continuously learns from new data, improving its diagnostic accuracy over time while maintaining transparency in its decision-making process.
                </p>
            </div>
        </div>
        
        <button class="next-page-btn" id="next-page-btn">Continue to Diagnosis Tool <i class="fas fa-arrow-right"></i></button>
    </div>

    <!-- Main Website Content (Initially Hidden) -->
    <div class="container" id="main-content">
        <header>
            <div class="logo">
                <div class="logo-text">PragnaAI Research</div>
            </div>
            <div class="subtitle">AI-powered Cancer Photoacoustic Diagnosis</div>
            <div class="author">"Intelligence that perceives diseases before it manifests."</div>
        </header>

        <!-- Lactic Acid Structure Information -->
        <div class="lactic-acid-info">
            <h4>Lactic Acid Molecular Structure</h4>
            <div class="lactic-acid-structure">
                CH₃-CH(OH)-COOH
            </div>
            <p>Key functional groups in lactic acid for cancer biomarker analysis</p>
        </div>

        <!-- Enhanced Progress Tracker -->
        <div class="progress-container">
            <div class="progress-step step-completed">
                <div class="step-number">1</div>
                <div class="step-text">Patient Information</div>
            </div>
            <div class="progress-step" id="step2">
                <div class="step-number">2</div>
                <div class="step-text">Lactic Acid Molecular Vibrations</div>
            </div>
            <div class="progress-step" id="step3">
                <div class="step-number">3</div>
                <div class="step-text">Diagnosis Results</div>
            </div>
            <div class="progress-step" id="step4">
                <div class="step-number">4</div>
                <div class="step-text">Follow-up Actions</div>
            </div>
        </div>

        <!-- API status element is present but hidden with CSS -->
        <div class="api-status" id="api-status" style="display: none;">
            <i class="fas fa-sync fa-spin"></i> Checking backend connection...
        </div>

        <!-- Patient Information Section -->
        <div class="section patient-info-section">
            <h2 class="section-title">Patient Information</h2>
            
            <div class="input-group">
                <label for="patient-name">Patient Name</label>
                <input type="text" id="patient-name" placeholder="Enter patient name...">
                <div class="feedback" id="name-feedback"></div>
            </div>
            
            <div class="input-group">
                <label for="patient-age">Patient Age</label>
                <input type="number" id="patient-age" min="1" max="120" placeholder="Enter patient age...">
                <div class="feedback" id="age-feedback"></div>
            </div>
            
            <!-- Gender Selection -->
            <div class="gender-selection">
                <label class="gender-label">Gender</label>
                <div class="gender-options">
                    <div class="gender-option">
                        <input type="radio" id="gender-male" name="gender" value="male">
                        <label for="gender-male">Male</label>
                    </div>
                    <div class="gender-option">
                        <input type="radio" id="gender-female" name="gender" value="female">
                        <label for="gender-female">Female</label>
                    </div>
                </div>
                <div class="feedback" id="gender-feedback"></div>
            </div>
        </div>

        <!-- Lactic Acid Molecular Vibrations Section -->
        <div class="section infrared-readings-section">
            <!-- Patient counter -->
            <div class="patient-counter" id="patient-counter">
                Patient 1: Provide Lactic Acid IR frequency readings in Mega Hertz (MHz)
            </div>
            
            <h2 class="section-title">Lactic Acid Molecular Vibrations</h2>
            
            <div class="input-group">
                <label for="input1">ENTER THE READING OF (-C=O) CARBONYL STRETCH OBSERVED IN PHOTOACOUSTIC SPECTROSCOPY.</label>
                <input type="number" step="0.01" id="input1" class="frequency-input" placeholder="Enter value...">
                <div class="feedback" id="feedback1"></div>
            </div>
            
            <div class="input-group">
                <label for="input2">ENTER THE READING OF (-CH₃) METHYL GROUP DEFORMATION OBSERVED IN PHOTOACOUSTIC SPECTROSCOPY.</label>
                <input type="number" step="0.01" id="input2" class="frequency-input" placeholder="Enter value...">
                <div class="feedback" id="feedback2"></div>
            </div>
            
            <div class="input-group">
                <label for="input3">ENTER THE READING OF (-C-OH) CARBON-OXYGEN STRETCH OBSERVED IN PHOTOACOUSTIC SPECTROSCOPY.</label>
                <input type="number" step="0.01" id="input3" class="frequency-input" placeholder="Enter value...">
                <div class="feedback" id="feedback3"></div>
            </div>
            
            <div class="input-group">
                <label for="input4">ENTER THE READING OF (-O-H) HYDROXYL STRETCH OBSERVED IN PHOTOACOUSTIC SPECTROSCOPY.</label>
                <input type="number" step="0.01" id="input4" class="frequency-input" placeholder="Enter value...">
                <div class="feedback" id="feedback4"></div>
            </div>
            
            <button class="btn" id="analyze-btn">Run Auto Analysis</button>
            
            <div class="next-patient" id="next-patient">
                <button class="btn btn-alt" id="next-btn">Next Patient</button>
            </div>
        </div>

        <!-- Diagnosis Results Section -->
        <div class="section">
            <h2 class="section-title">Diagnosis Results</h2>
            
            <div class="result" id="result">
                <h3>Patient Diagnosis</h3>
                
                <!-- Enhanced AI Reasoning Section -->
                <div class="ai-reasoning" id="ai-reasoning" style="display: none;">
                    <h4>AI Reasoning Process</h4>
                    <p id="reasoning-text">The AI is analyzing lactic acid molecular vibration patterns and comparing them to established cancer biomarkers...</p>
                    
                    <div class="confidence-meter">
                        <div class="confidence-label">
                            <span>Confidence Level:</span>
                            <span id="confidence-value">0%</span>
                        </div>
                        <div class="confidence-bar">
                            <div class="confidence-fill" id="confidence-fill"></div>
                        </div>
                    </div>
                    
                    <div class="data-source">
                        <i class="fas fa-database"></i> Data sources: Lactic Acid IR Database, Cancer Biomarker Library, Clinical Guidelines
                    </div>
                </div>
                
                <div class="probability-meter">
                    <div class="probability-fill" id="probability-fill"></div>
                </div>
                
                <div class="probability-labels">
                    <span>0%</span>
                    <span>50%</span>
                    <span>100%</span>
                </div>
                
                <div class="risk-level" id="risk-level"></div>
                <div id="probability-text">Probability: <span id="probability-value">0</span>%</div>
                <div class="recommendation" id="recommendation"></div>
                
                <!-- Enhanced Decision Log -->
                <div class="decision-log" id="decision-log">
                    <h4>Decision Log</h4>
                    <div class="log-entry">
                        <div class="log-time">12:05:23</div>
                        <div>Initialized lactic acid molecular analysis</div>
                    </div>
                </div>
                
                <!-- Multi-Agent System Display -->
                <div class="multi-agent-system" id="multi-agent-system">
                    <h4>Multi-Agent Collaboration System</h4>
                    <div class="agent-grid">
                        <div class="agent-card">
                            <strong>Lactic Acid Analysis Agent</strong><br>
                            Analyzing molecular patterns in lactic acid
                        </div>
                        <div class="agent-card">
                            <strong>Cancer Biomarker Agent</strong><br>
                            Calculating cancer probability scores
                        </div>
                        <div class="agent-card">
                            <strong>Clinical Correlation Agent</strong><br>
                            Recommending medical follow-up
                        </div>
                        <div class="agent-card">
                            <strong>Ethical Safety Agent</strong><br>
                            Ensuring safe recommendations
                        </div>
                    </div>
                </div>
                
                <!-- Proactive Actions -->
                <div class="proactive-actions" id="proactive-actions">
                    <h4>Proactive Recommendations</h4>
                    <div class="action-item">
                        <i class="fas fa-robot action-icon"></i>
                        <span id="proactive-text">Analyzing lactic acid metabolic patterns...</span>
                    </div>
                </div>
                
                <!-- Action buttons for all probability levels -->
                <div class="action-buttons" id="action-buttons">
                    <button class="action-btn schedule" id="schedule-btn">Schedule Follow-up Tests</button>
                    <button class="action-btn" id="research-btn">Research Metabolic Patterns</button>
                </div>
                
                <!-- Scheduling Options - Shown for all probability levels -->
                <div class="scheduling-options" id="scheduling-options">
                    <h3 class="scheduling-title">Schedule Follow-up Tests</h3>
                    
                    <div class="scheduling-urgency">
                        <div class="urgency-option urgency-high" data-urgency="high">
                            <div class="urgency-icon"><i class="fas fa-exclamation-triangle"></i></div>
                            <div class="urgency-title">High Urgency</div>
                            <div class="urgency-desc">Within 24-48 hours</div>
                        </div>
                        <div class="urgency-option urgency-medium" data-urgency="medium">
                            <div class="urgency-icon"><i class="fas fa-clock"></i></div>
                            <div class="urgency-title">Medium Urgency</div>
                            <div class="urgency-desc">Within 1-2 weeks</div>
                        </div>
                        <div class="urgency-option urgency-low" data-urgency="low">
                            <div class="urgency-icon"><i class="fas fa-calendar-check"></i></div>
                            <div class="urgency-title">Low Urgency</div>
                            <div class="urgency-desc">Within 1 month</div>
                        </div>
                    </div>
                    
                    <!-- Test Suggestions Based on Probability -->
                    <div class="test-suggestions" id="test-suggestions">
                        <h5>Recommended Tests Based on Your Risk Level:</h5>
                        <ul id="suggested-tests-list">
                            <!-- Suggested tests will be populated here -->
                        </ul>
                    </div>
                    
                    <div class="test-options">
                        <h4>Select Diagnostic Tests</h4>
                        <div class="test-grid">
                            <div class="test-option" data-test="biopsy">
                                <input type="checkbox" class="test-checkbox" id="test-biopsy">
                                <label for="test-biopsy" class="test-name">Biopsy</label>
                            </div>
                            <div class="test-option" data-test="ct-scan">
                                <input type="checkbox" class="test-checkbox" id="test-ct">
                                <label for="test-ct" class="test-name">CT Scan</label>
                            </div>
                            <div class="test-option" data-test="mri">
                                <input type="checkbox" class="test-checkbox" id="test-mri">
                                <label for="test-mri" class="test-name">MRI</label>
                            </div>
                            <div class="test-option" data-test="xray">
                                <input type="checkbox" class="test-checkbox" id="test-xray">
                                <label for="test-xray" class="test-name">X-Ray</label>
                            </div>
                            <div class="test-option" data-test="ultrasound">
                                <input type="checkbox" class="test-checkbox" id="test-ultrasound">
                                <label for="test-ultrasound" class="test-name">Ultrasound</label>
                            </div>
                            <div class="test-option" data-test="blood-test">
                                <input type="checkbox" class="test-checkbox" id="test-blood">
                                <label for="test-blood" class="test-name">Blood Test</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="schedule-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="preferred-date">Preferred Date</label>
                                <input type="date" id="preferred-date">
                            </div>
                            <div class="form-group">
                                <label for="preferred-time">Preferred Time</label>
                                <select id="preferred-time">
                                    <option value="">Select time</option>
                                    <option value="morning">Morning (8AM-12PM)</option>
                                    <option value="afternoon">Afternoon (12PM-4PM)</option>
                                    <option value="evening">Evening (4PM-7PM)</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="additional-notes">Additional Notes (Optional)</label>
                            <textarea id="additional-notes" rows="3" placeholder="Any specific concerns or requirements..."></textarea>
                        </div>
                        <button class="schedule-submit" id="schedule-submit">Confirm Schedule</button>
                    </div>
                </div>
                
                <!-- Molecular Reasons Section - Only shown for high risk -->
                <div class="molecular-reasons" id="molecular-reasons" style="display: none;">
                    <h4>MOLECULAR REASONS OF CANCER DETECTION</h4>
                    <ul>
                        <li>Abnormal lactic acid metabolism in cancer cells (Warburg effect)</li>
                        <li>Altered carbonyl group vibrations indicating metabolic stress</li>
                        <li>Changed hydroxyl group patterns suggesting pH alterations</li>
                        <li>Modified methyl group deformations in cancerous tissue</li>
                    </ul>
                    <div class="sequence-example">
                        Normal Lactic Acid Metabolism <span class="sequence-arrow">→</span> Cancerous Metabolic Shift
                    </div>
                    <p style="text-align: center; margin-top: 10px; font-style: italic;">
                        Cancer cells show altered lactic acid production and molecular vibration patterns due to aerobic glycolysis
                    </p>
                </div>
                
                <div class="patient-info" id="patient-info">
                    <!-- Patient information will be displayed here -->
                </div>
            </div>
        </div>
        
        <!-- Adaptive Learning Section -->
        <div class="adaptive-learning" id="adaptive-learning">
            <h4>Adaptive Learning System</h4>
            <p>This system continuously improves its diagnostic accuracy by learning from new lactic acid biomarker data and clinical outcomes.</p>
            <div class="confidence-meter">
                <div class="confidence-label">
                    <span>Synthetic demo metric:</span>
                    <span id="model-accuracy">85%</span>
                </div>
                <div class="confidence-bar">
                    <div class="confidence-fill" style="width: 94.2%"></div>
                </div>
            </div>
        </div>
        
        <!-- Disclaimer Section -->
        <div class="disclaimer">
            <i class="fas fa-exclamation-triangle"></i> 
            <strong>Important Notice:</strong> This page demonstrates a conceptual workflow for AI-assisted interpretation of lactic acid infrared/photoacoustic spectral features in cancer detection. Real diagnostic systems analyze complete metabolic profiles, perform rigorous validation, and are evaluated in clinical studies. This demo is for education only.
        </div>
    </div>
    
    <!-- Added footer text below the container -->
    <div class="footer-text">
        PragnaAI Cancer Diagnosis<br>
        © 2025 PragnaAI Research
    </div>
    
    <!-- Redirect Page -->
    <div class="redirect-page" id="redirect-page">
        <div class="redirect-content">
            <h2 class="redirect-title">PROTOTYPE MODEL</h2>
            <p class="redirect-message">This is a prototype model. The actual model will redirect you to an authorized lab test website integrated with PragnaAI.</p>
            <button class="back-btn" id="back-btn">Back to Diagnosis</button>
        </div>
    </div>

    <script>
        // Lighter Dense Net Background Code
        const canvas = document.getElementById('bg');
        const ctx = canvas.getContext('2d');

        function draw() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            const points = [];
            const spacing = 80; // smaller spacing = more dots

            // Generate more points
            for (let x = 0; x < canvas.width; x += spacing) {
                for (let y = 0; y < canvas.height; y += spacing) {
                    points.push({
                        x: x + Math.random() * 30,
                        y: y + Math.random() * 30
                    });
                }
            }

            // Draw connecting lines with lighter color
            ctx.strokeStyle = 'rgba(0,0,0,0.1)'; // Lighter lines
            ctx.lineWidth = 1;
            const maxDist = spacing * 1.8; // increase connection range
            for (let i = 0; i < points.length; i++) {
                for (let j = i + 1; j < points.length; j++) {
                    const dx = points[i].x - points[j].x;
                    const dy = points[i].y - points[j].y;
                    const dist = Math.sqrt(dx * dx + dy * dy);
                    if (dist < maxDist) {
                        ctx.beginPath();
                        ctx.moveTo(points[i].x, points[i].y);
                        ctx.lineTo(points[j].x, points[j].y);
                        ctx.stroke();
                    }
                }
            }

            // Draw dots with lighter color
            ctx.fillStyle = 'rgba(0,0,0,0.25)'; // Lighter dots
            points.forEach(p => {
                ctx.beginPath();
                ctx.arc(p.x, p.y, 2, 0, Math.PI * 2); // Smaller dots
                ctx.fill();
            });
        }

        draw();
        window.addEventListener('resize', draw);

        // Corrected Configuration for Lactic Acid
        const REGION_NAMES = [
            "ENTER THE READING OF (-C=O) CARBONYL STRETCH OBSERVED IN PHOTOACOUSTIC SPECTROSCOPY.",
            "ENTER THE READING OF (-CH₃) METHYL GROUP DEFORMATION OBSERVED IN PHOTOACOUSTIC SPECTROSCOPY.",
            "ENTER THE READING OF (-C-OH) CARBON-OXYGEN STRETCH OBSERVED IN PHOTOACOUSTIC SPECTROSCOPY.",
            "ENTER THE READING OF (-O-H) HYDROXYL STRETCH OBSERVED IN PHOTOACOUSTIC SPECTROSCOPY."
        ];

        // Lactic Acid specific normal ranges
        const NORMAL_MEANS = [1.2, 1.8, 2.8, 2.2];
        const NORMAL_STDS = [0.4, 0.6, 0.7, 0.9];
        const THRESHOLD = 0.42;

        // Enhanced State
        let patientCount = 1;
        let backendAvailable = false;
        let vibrationChart = null;
        let autoTriggerTimeout = null;
        let currentProbability = 0;
        let decisionLog = [];

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Set up Get Started button
            document.getElementById('get-started-btn').addEventListener('click', function() {
                document.getElementById('welcome-screen').style.opacity = '0';
                setTimeout(function() {
                    document.getElementById('welcome-screen').style.display = 'none';
                    document.getElementById('educational-page').style.display = 'flex';
                }, 500);
            });
            
            // Set up Next Page button
            document.getElementById('next-page-btn').addEventListener('click', function() {
                document.getElementById('educational-page').style.display = 'none';
                document.getElementById('main-content').style.display = 'block';
            });
            
            // Check backend connection
            checkBackendConnection();
            
            // Set up event listeners for frequency inputs
            document.querySelectorAll('.frequency-input').forEach((input, index) => {
                input.addEventListener('input', () => {
                    validateInput(index);
                    updateVibrationGraph();
                    
                    // Auto-trigger analysis when all inputs are filled
                    clearTimeout(autoTriggerTimeout);
                    autoTriggerTimeout = setTimeout(autoTriggerAnalysis, 1000);
                });
            });
            
            // Set up event listeners for patient info
            document.getElementById('patient-name').addEventListener('input', validatePatientInfo);
            document.getElementById('patient-age').addEventListener('input', validatePatientInfo);
            
            // Set up event listeners for gender selection
            document.querySelectorAll('input[name="gender"]').forEach(radio => {
                radio.addEventListener('change', validatePatientInfo);
            });
            
            document.getElementById('analyze-btn').addEventListener('click', analyzePatient);
            document.getElementById('next-btn').addEventListener('click', nextPatient);
            
            // Set up action buttons
            document.getElementById('schedule-btn').addEventListener('click', function() {
                document.getElementById('scheduling-options').style.display = 'block';
                prefillSchedulingOptions();
            });
            
            document.getElementById('research-btn').addEventListener('click', function() {
                simulateMetabolicResearch();
            });
            
            document.getElementById('back-btn').addEventListener('click', function() {
                document.getElementById('redirect-page').style.display = 'none';
            });
            
            // Set up scheduling options
            document.querySelectorAll('.urgency-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.urgency-option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    this.classList.add('selected');
                });
            });
            
            document.querySelectorAll('.test-option').forEach(option => {
                option.addEventListener('click', function() {
                    const checkbox = this.querySelector('.test-checkbox');
                    checkbox.checked = !checkbox.checked;
                    this.classList.toggle('selected', checkbox.checked);
                });
            });
            
            document.getElementById('schedule-submit').addEventListener('click', submitSchedule);
            
            // Initialize the vibration graph
            initializeVibrationGraph();
            
            // Add initial log entry
            addLogEntry("Lactic acid biomarker analysis system initialized");
            addLogEntry("Multi-agent collaboration system activated");
        });

        // Simulate metabolic research
        function simulateMetabolicResearch() {
            addLogEntry("Researching lactic acid metabolic patterns in cancer database");
            
            // Show loading state
            const researchBtn = document.getElementById('research-btn');
            const originalText = researchBtn.innerHTML;
            researchBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Researching...';
            researchBtn.disabled = true;
            
            setTimeout(() => {
                addLogEntry("Found 28 similar metabolic patterns with 92% match confidence");
                addLogEntry("Research complete - patterns consistent with Warburg effect");
                
                // Show proactive recommendation based on research
                const proactiveText = document.getElementById('proactive-text');
                proactiveText.innerHTML = "Based on metabolic research, recommend lactate dehydrogenase (LDH) testing";
                
                researchBtn.innerHTML = originalText;
                researchBtn.disabled = false;
            }, 2000);
        }

        // Add entry to decision log
        function addLogEntry(message) {
            const now = new Date();
            const timeString = now.toTimeString().split(' ')[0];
            
            decisionLog.push({
                time: timeString,
                message: message
            });
            
            // Update the log display
            const logContainer = document.getElementById('decision-log');
            const logEntries = logContainer.querySelectorAll('.log-entry');
            
            // Remove old entries if we have more than 5
            if (logEntries.length >= 5) {
                logEntries[0].remove();
            }
            
            // Add new entry
            const newEntry = document.createElement('div');
            newEntry.className = 'log-entry';
            newEntry.innerHTML = `
                <div class="log-time">${timeString}</div>
                <div>${message}</div>
            `;
            
            logContainer.appendChild(newEntry);
        }

        // Prefill scheduling options based on probability
        function prefillSchedulingOptions() {
            // Set urgency based on probability
            let urgencyLevel = 'low';
            if (currentProbability > 0.8) {
                urgencyLevel = 'high';
            } else if (currentProbability >= 0.5) {
                urgencyLevel = 'medium';
            }
            
            document.querySelectorAll('.urgency-option').forEach(option => {
                if (option.dataset.urgency === urgencyLevel) {
                    option.classList.add('selected');
                } else {
                    option.classList.remove('selected');
                }
            });
            
            // Clear all checkboxes first
            document.querySelectorAll('.test-checkbox').forEach(checkbox => {
                checkbox.checked = false;
            });
            document.querySelectorAll('.test-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Set test suggestions based on probability
            const suggestionsList = document.getElementById('suggested-tests-list');
            suggestionsList.innerHTML = '';
            
            if (currentProbability > 0.8) {
                // High probability - suggest comprehensive testing
                suggestionsList.innerHTML = `
                    <li><strong>Biopsy</strong> - Recommended for tissue analysis</li>
                    <li><strong>Blood Test</strong> - Recommended for LDH and cancer markers</li>
                    <li><strong>CT Scan</strong> - Recommended for detailed imaging</li>
                    <li><strong>Metabolic Panel</strong> - Recommended for lactic acid levels</li>
                `;
                
                // Pre-select these tests
                document.getElementById('test-biopsy').checked = true;
                document.querySelector('.test-option[data-test="biopsy"]').classList.add('selected');
                document.getElementById('test-blood').checked = true;
                document.querySelector('.test-option[data-test="blood-test"]').classList.add('selected');
                document.getElementById('test-ct').checked = true;
                document.querySelector('.test-option[data-test="ct-scan"]').classList.add('selected');
            } else if (currentProbability >= 0.5) {
                // Medium probability - suggest targeted testing
                suggestionsList.innerHTML = `
                    <li><strong>Blood Test</strong> - Recommended for LDH and cancer markers</li>
                    <li><strong>Ultrasound</strong> - Recommended for initial screening</li>
                    <li><strong>Metabolic Panel</strong> - Recommended for lactic acid levels</li>
                `;
                
                // Pre-select these tests
                document.getElementById('test-blood').checked = true;
                document.querySelector('.test-option[data-test="blood-test"]').classList.add('selected');
            } else {
                // Low probability - suggest optional screening
                suggestionsList.innerHTML = `
                    <li><strong>Blood Test</strong> - Optional screening for LDH levels</li>
                    <li><strong>Ultrasound</strong> - Non-invasive imaging option</li>
                `;
            }
            
            // Set default date (tomorrow)
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            document.getElementById('preferred-date').valueAsDate = tomorrow;
            
            // Reset preferred time to default (empty)
            document.getElementById('preferred-time').value = '';
        }

        // Submit schedule
        function submitSchedule() {
            const urgencyOption = document.querySelector('.urgency-option.selected');
            if (!urgencyOption) {
                alert('Please select an urgency level');
                return;
            }
            
            const selectedTests = Array.from(document.querySelectorAll('.test-checkbox:checked'))
                .map(checkbox => checkbox.nextElementSibling.textContent);
            
            if (selectedTests.length === 0) {
                alert('Please select at least one test');
                return;
            }
            
            const preferredDate = document.getElementById('preferred-date').value;
            if (!preferredDate) {
                alert('Please select a preferred date');
                return;
            }
            
            const preferredTime = document.getElementById('preferred-time').value;
            if (!preferredTime) {
                alert('Please select a preferred time');
                return;
            }
            
            // Show the redirect page instead of an alert
            document.getElementById('redirect-page').style.display = 'flex';
            
            // Hide scheduling options
            document.getElementById('scheduling-options').style.display = 'none';
            
            // Log the scheduling action
            addLogEntry(`Scheduled ${selectedTests.join(', ')} with ${urgencyOption.dataset.urgency} urgency`);
        }

        // Auto-trigger analysis when all inputs are filled
        function autoTriggerAnalysis() {
            // Check if all frequency inputs have values
            const allFilled = Array.from(document.querySelectorAll('.frequency-input'))
                .every(input => input.value && input.value.trim() !== '');
            
            // Check if patient info is filled
            const nameInput = document.getElementById('patient-name');
            const ageInput = document.getElementById('patient-age');
            const patientInfoFilled = nameInput.value.trim() !== '' && 
                                     ageInput.value && 
                                     parseInt(ageInput.value) >= 1 && 
                                     parseInt(ageInput.value) <= 120;
            
            if (allFilled && patientInfoFilled) {
                analyzePatient();
            }
        }

        // Initialize the vibration graph
        function initializeVibrationGraph() {
            const ctx = document.getElementById('vibration-graph').getContext('2d');
            
            vibrationChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['-C=O Carbonyl (1720 cm⁻¹)', '-CH₃ Methyl (1300 cm⁻¹)', '-C-OH C-O Stretch (1100 cm⁻¹)', '-O-H Hydroxyl (3500 cm⁻¹)'],
                    datasets: [{
                        label: 'Vibration Intensity',
                        data: [0, 0, 0, 0],
                        borderColor: '#0d4a8c',
                        backgroundColor: 'rgba(13, 74, 140, 0.1)',
                        borderWidth: 2,
                        pointBackgroundColor: '#0d4a8c',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        pointHoverRadius: 8,
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'Normal Range',
                        data: NORMAL_MEANS,
                        borderColor: '#2ecc71',
                        backgroundColor: 'transparent',
                        borderWidth: 2,
                        borderDash: [5, 5],
                        pointRadius: 0,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Intensity (MHz)',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Lactic Acid Molecular Vibrations',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.7)',
                            titleFont: {
                                size: 14
                            },
                            bodyFont: {
                                size: 13
                            }
                        }
                    }
                }
            });
        }

        // Update the vibration graph with current input values
        function updateVibrationGraph() {
            if (!vibrationChart) return;
            
            const values = [];
            for (let i = 1; i <= 4; i++) {
                const input = document.getElementById(`input${i}`);
                values.push(input.value ? parseFloat(input.value) : 0);
            }
            
            vibrationChart.data.datasets[0].data = values;
            vibrationChart.update();
        }

        // Check if backend is available
        async function checkBackendConnection() {
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/posts/1', {
                    method: 'GET'
                });
                
                if (response.ok) {
                    backendAvailable = true;
                    addLogEntry("Backend connection established");
                } else {
                    backendAvailable = false;
                    addLogEntry("Backend unavailable - using enhanced lactic acid analysis model");
                }
            } catch (error) {
                backendAvailable = false;
                addLogEntry("Backend connection failed - using enhanced lactic acid analysis model");
            }
        }

        // Validate patient information
        function validatePatientInfo() {
            const nameInput = document.getElementById('patient-name');
            const ageInput = document.getElementById('patient-age');
            const nameFeedback = document.getElementById('name-feedback');
            const ageFeedback = document.getElementById('age-feedback');
            
            // Validate name
            if (nameInput.value.trim() === '') {
                nameFeedback.className = 'feedback error';
                nameFeedback.innerHTML = '⚠️ Please enter patient name';
                nameInput.style.borderColor = '#e74c3c';
            } else {
                nameFeedback.className = 'feedback';
                nameInput.style.borderColor = '';
            }
            
            // Validate age
            if (!ageInput.value) {
                ageFeedback.className = 'feedback error';
                ageFeedback.innerHTML = '⚠️ Please enter patient age';
                ageInput.style.borderColor = '#e74c3c';
            } else if (parseInt(ageInput.value) < 1 || parseInt(ageInput.value) > 120) {
                ageFeedback.className = 'feedback error';
                ageFeedback.innerHTML = '⚠️ Please enter a valid age (1-120)';
                ageInput.style.borderColor = '#e74c3c';
            } else {
                ageFeedback.className = 'feedback';
                ageInput.style.borderColor = '';
            }
        }

        // Validate input and provide feedback
        function validateInput(index) {
            const input = document.getElementById(`input${index+1}`);
            const feedback = document.getElementById(`feedback${index+1}`);
            
            if (!input.value) {
                feedback.className = 'feedback';
                return;
            }
            
            const value = parseFloat(input.value);
            
            // Check for negative values
            if (value < 0) {
                feedback.className = 'feedback error';
                feedback.innerHTML = '❌ Negative values are not allowed';
                input.style.borderColor = '#e74c3c';
                return;
            }
            
            const mean = NORMAL_MEANS[index];
            const std = NORMAL_STDS[index];
            
            if (Math.abs(value - mean) <= std) {
                feedback.className = 'feedback normal';
                feedback.innerHTML = '✅ At normal level';
                input.style.borderColor = '';
            } else if (value > mean) {
                feedback.className = 'feedback high';
                feedback.innerHTML = '⚠️ Higher than normal level';
                input.style.borderColor = '';
            } else {
                feedback.className = 'feedback low';
                feedback.innerHTML = '⚠️ Lower than normal level';
                input.style.borderColor = '';
            }
        }

        // Analyze patient data
        async function analyzePatient() {
            // Validate patient info
            const nameInput = document.getElementById('patient-name');
            const ageInput = document.getElementById('patient-age');
            
            if (nameInput.value.trim() === '' || !ageInput.value || 
                parseInt(ageInput.value) < 1 || parseInt(ageInput.value) > 120) {
                validatePatientInfo();
                alert('Please fill in valid patient information');
                return;
            }
            
            // Get input values
            const values = [];
            let allFilled = true;
            let hasNegative = false;
            
            for (let i = 1; i <= 4; i++) {
                const input = document.getElementById(`input${i}`);
                if (!input.value) {
                    allFilled = false;
                    input.style.borderColor = '#e74c3c';
                } else if (parseFloat(input.value) < 0) {
                    hasNegative = true;
                    input.style.borderColor = '#e74c3c';
                } else {
                    input.style.borderColor = '';
                    values.push(parseFloat(input.value));
                }
            }
            
            if (!allFilled) {
                alert('Please fill in all fields');
                return;
            }
            
            if (hasNegative) {
                alert('Negative values are not allowed. Please enter positive values only.');
                return;
            }
            
            // Update progress tracker
            document.getElementById('step2').classList.add('step-completed');
            
            // Show loading state
            document.getElementById('analyze-btn').innerHTML = '<i class="fas fa-spinner fa-spin"></i> Enhanced Analysis...';
            document.getElementById('analyze-btn').disabled = true;
            
            // Add log entries
            addLogEntry("Starting lactic acid molecular analysis");
            addLogEntry("Analyzing 4 key lactic acid biomarkers");
            
            let probability;
            
            if (backendAvailable) {
                try {
                    const response = await fetch('https://your-backend-url.com/api/predict', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ values: values })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        probability = data.probability;
                        addLogEntry("Received prediction from lactic acid analysis model");
                    } else {
                        throw new Error('Backend prediction failed');
                    }
                } catch (error) {
                    console.error('Backend call failed:', error);
                    probability = enhancedLacticAcidPrediction(values);
                    addLogEntry("Using enhanced lactic acid analysis model");
                }
            } else {
                probability = enhancedLacticAcidPrediction(values);
                addLogEntry("Using enhanced lactic acid analysis model");
            }
            
            // Store current probability for scheduling
            currentProbability = probability;
            
            // Get gender values
            const selectedGender = document.querySelector('input[name="gender"]:checked');
            const genderDisplay = selectedGender 
                ? selectedGender.value.charAt(0).toUpperCase() + selectedGender.value.slice(1)
                : 'Not Specified';
            
            // Display results
            displayResults(probability, nameInput.value, ageInput.value, genderDisplay);
            
            // Reset button
            document.getElementById('analyze-btn').innerHTML = 'Run Auto Analysis';
            document.getElementById('analyze-btn').disabled = false;
            
            // Show next patient button
            document.getElementById('next-patient').style.display = 'block';
            document.getElementById('analyze-btn').style.display = 'none';
            
            // Update progress tracker
            document.getElementById('step3').classList.add('step-completed');
        }

        // Enhanced lactic acid prediction
        function enhancedLacticAcidPrediction(values) {
            // Lactic acid specific analysis with biological weighting
            const biologicalWeights = [1.3, 1.0, 0.9, 1.2]; // Carbonyl most important for cancer detection
            
            let weightedScore = 0;
            for (let i = 0; i < values.length; i++) {
                const deviation = Math.max(0, (values[i] - NORMAL_MEANS[i]) / NORMAL_STDS[i]);
                weightedScore += deviation * biologicalWeights[i];
            }
            
            // Convert to probability with lactic acid specific calibration
            const probability = 1 / (1 + Math.exp(-weightedScore * 0.6 + 2.2));
            
            // Add some randomness to simulate real model behavior
            return Math.min(0.99, probability + (Math.random() * 0.06 - 0.03));
        }

        // Display results
        function displayResults(probability, name, age, gender) {
            const resultDiv = document.getElementById('result');
            const probabilityFill = document.getElementById('probability-fill');
            const probabilityValue = document.getElementById('probability-value');
            const riskLevel = document.getElementById('risk-level');
            const recommendation = document.getElementById('recommendation');
            const patientInfo = document.getElementById('patient-info');
            const molecularReasons = document.getElementById('molecular-reasons');
            const actionButtons = document.getElementById('action-buttons');
            const schedulingOptions = document.getElementById('scheduling-options');
            const reasoningText = document.getElementById('reasoning-text');
            const confidenceValue = document.getElementById('confidence-value');
            const confidenceFill = document.getElementById('confidence-fill');
            const proactiveText = document.getElementById('proactive-text');
            const aiReasoning = document.getElementById('ai-reasoning');
            
            // Show AI reasoning section
            aiReasoning.style.display = 'block';
            
            // Hide scheduling options initially
            schedulingOptions.style.display = 'none';
            
            // Update probability meter
            const percentage = Math.round(probability * 100);
            probabilityFill.style.width = `${percentage}%`;
            probabilityValue.textContent = percentage;
            
            // Set confidence level based on data quality and probability
            const confidence = Math.min(95, 75 + (probability * 20) + (Math.random() * 10));
            confidenceValue.textContent = `${Math.round(confidence)}%`;
            confidenceFill.style.width = `${confidence}%`;
            
            // Set AI reasoning text based on probability
            if (probability >= THRESHOLD) {
                reasoningText.textContent = "The AI has detected abnormal lactic acid molecular vibration patterns consistent with cancer metabolic alterations. The elevated carbonyl and hydroxyl vibrations suggest Warburg effect activity in potential cancerous tissue.";
                proactiveText.textContent = "Proactive recommendation: Schedule oncology consultation and LDH testing";
            } else {
                reasoningText.textContent = "The lactic acid molecular vibration patterns appear within normal metabolic ranges. No significant biomarkers associated with cancer metabolism were detected in this analysis.";
                proactiveText.textContent = "Proactive monitoring: Recommend routine metabolic screening in 12 months";
            }
            
            // Set colors and text based on risk
            if (probability >= THRESHOLD) {
                resultDiv.className = 'result high-risk';
                probabilityFill.style.background = 'linear-gradient(90deg, #e74c3c, #c0392b)';
                riskLevel.innerHTML = '⚠️ HIGH RISK OF CANCER DETECTION';
                riskLevel.style.color = '#c0392b';
                
                // Show molecular reasons section for high risk
                molecularReasons.style.display = 'block';
                addLogEntry("High cancer risk detected - abnormal lactic acid metabolism");
                addLogEntry("Warburg effect patterns identified in molecular vibrations");
            } else {
                resultDiv.className = 'result low-risk';
                probabilityFill.style.background = 'linear-gradient(90deg, #2ecc71, #27ae60)';
                riskLevel.innerHTML = '✅ LOW RISK OF CANCER DETECTION';
                riskLevel.style.color = '#27ae60';
                
                // Hide molecular reasons section for low risk
                molecularReasons.style.display = 'none';
                addLogEntry("Low cancer risk detected - normal lactic acid metabolism");
            }
            
            // Set recommendation based on probability ranges
            if (probability > 0.8) {
                recommendation.innerHTML = `<strong>HIGH PRIORITY AND URGENT FOLLOW UP:</strong> <strong>${name}</strong> shows very high probability of cancer-associated lactic acid metabolism. Immediate comprehensive evaluation including metabolic panel, LDH testing, and oncology consultation is recommended.`;
                addLogEntry("High priority metabolic follow-up recommended");
            } else if (probability >= 0.5 && probability <= 0.8) {
                recommendation.innerHTML = `<strong>METABOLIC EVALUATION:</strong> <strong>${name}</strong> shows moderate probability of altered lactic acid metabolism. Secondary diagnostics including targeted metabolic panel and LDH testing are recommended.`;
                addLogEntry("Metabolic evaluation recommended");
            } else {
                recommendation.innerHTML = `<strong>ROUTINE METABOLIC SCREENING:</strong> <strong>${name}</strong> shows low probability of cancer-associated metabolic changes. Maintain routine metabolic screening with consideration of individual risk factors.`;
                addLogEntry("Routine metabolic screening recommended");
            }
            
            // Show action buttons for all probability levels
            actionButtons.style.display = 'flex';
            
            // Display patient information
            patientInfo.innerHTML = `
                <p><strong>Patient Name:</strong> ${name}</p>
                <p><strong>Patient Age:</strong> ${age}</p>
                <p><strong>Patient Gender:</strong> ${gender}</p>
                <p><strong>Analysis Method:</strong> Lactic Acid Molecular Vibration Analysis</p>
                <p><strong>Biomarkers Analyzed:</strong> 4 key lactic acid functional groups</p>
                <p><strong>Diagnosis Date:</strong> ${new Date().toLocaleDateString()}</p>
            `;
            
            // Show results
            resultDiv.style.display = 'block';
            
            // Update progress tracker
            document.getElementById('step4').classList.add('step-completed');
            
            // Add final log entry
            addLogEntry(`Lactic acid analysis complete - ${percentage}% probability with ${Math.round(confidence)}% confidence`);
        }

        // Reset for next patient
        function nextPatient() {
            patientCount++;
            
            // Clear inputs
            document.getElementById('patient-name').value = '';
            document.getElementById('patient-age').value = '';
            document.getElementById('name-feedback').className = 'feedback';
            document.getElementById('age-feedback').className = 'feedback';
            
            // Clear gender radio buttons
            document.querySelectorAll('input[name="gender"]').forEach(radio => {
                radio.checked = false;
            });
            
            for (let i = 1; i <= 4; i++) {
                document.getElementById(`input${i}`).value = '';
                document.getElementById(`feedback${i}`).className = 'feedback';
            }
            
            // Reset graph
            if (vibrationChart) {
                vibrationChart.data.datasets[0].data = [0, 0, 0, 0];
                vibrationChart.update();
            }
            
            // Hide results
            document.getElementById('result').style.display = 'none';
            document.getElementById('ai-reasoning').style.display = 'none';
            
            // Hide scheduling options
            document.getElementById('scheduling-options').style.display = 'none';
            
            // Reset proactive text
            document.getElementById('proactive-text').textContent = "Analyzing lactic acid metabolic patterns...";
            
            // Update patient counter
            document.getElementById('patient-counter').textContent = `Patient ${patientCount}: Provide Lactic Acid IR frequency readings in Mega Hertz (MHz)`;
            
            // Show analyze button, hide next button
            document.getElementById('analyze-btn').style.display = 'block';
            document.getElementById('next-patient').style.display = 'none';
            
            // Reset progress tracker (keep step 1 completed)
            document.getElementById('step2').classList.remove('step-completed');
            document.getElementById('step3').classList.remove('step-completed');
            document.getElementById('step4').classList.remove('step-completed');
            
            // Clear decision log
            document.getElementById('decision-log').innerHTML = '<h4>Decision Log</h4>';
            decisionLog = [];
            addLogEntry("Lactic acid biomarker system ready for new patient data");
            addLogEntry("Multi-agent collaboration system active");
        }
    </script>
</body>
</html>
